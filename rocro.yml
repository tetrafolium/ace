---
inspecode:

  global:
    ignore:
      - "node_modules"

  tools:

    clang-format:
      auto-fix: true
      thresholds: {num-issues: 727}

    cpd:
      ignore:
        - "**/*_test.js"
      options:
        --minimum-tokens: 200
        --skip-lexical-errors:
      thresholds: {num-issues: 732}

    eslint:
      auto-fix: true
      thresholds: {num-issues: 125}

    flow:
      thresholds: {num-issues: 0}   # found no input files

    # fortify:
    #   thresholds: {num-issues: 999}

    fossology:
      thresholds: {num-issues: 49}

    grep:
      thresholds: {num-issues: 110}

    #### HTMLHint was aborted unexpectedly.
    # htmlhint:
    #   thresholds: {num-issues: 999}

    jscpd:
    - thresholds: {num-issues: 410}
    - ignore:
        - "**/*_test.js"
      thresholds: {num-issues: 347}

    jshint:
      config-file: "inspecode-jshintrc.json"
      thresholds: {num-issues: 929}

    misspell:
      auto-fix: true
      thresholds: {num-issues: 107}

    npm-audit:
      auto-fix: true
      thresholds: {num-issues: 4}

    npm-test:
      thresholds: {num-issues: 0}

    phpcs:
      options:
        --standard: PEAR
        --exclude:
          - Generic.Commenting.DocComment
          - Generic.ControlStructures.InlineControlStructure
          - Generic.WhiteSpace.DisallowTabIndent
          - PEAR.ControlStructures.MultiLineCondition
          - PEAR.Functions.FunctionCallSignature
          - PEAR.Functions.FunctionDeclaration
          - PEAR.WhiteSpace.ScopeIndent
          - Squiz.Commenting.DocCommentAlignment
      machine: {cpu: 1.0}   # to avoid PHP Fatal error (described below)
          ## PHP Fatal error:  Allowed memory size of 2768240640 bytes exhausted (tried to allocate 20480 bytes) in phar:///opt/phpcs/phpcs.phar/src/Tokenizers/JS.php on line 2
      thresholds: {num-issues: 17}

    pmd:
    - ignore:
        - "lib/ace/mode/xquery/xqlint.js"         # 11653 violations
        - "lib/ace/mode/coffee/coffee.js"         #  1206 violations
        - "lib/ace/mode/xquery/xquery_lexer.js"   #   209 violations
        - "lib/ace/mode/xquery/jsoniq_lexer.js"   #   195 violations
      thresholds: {num-issues: 883}
    - config-file: "inspecode-pmd.xml"
      thresholds: {num-issues: 876}

    prettier:
    - #### FATAL ERROR: MarkCompactCollector: young object promotion failed Allocation failed - JavaScript heap out of memory
      # auto-fix: true    # disabled to avoid break pipeline
      thresholds: {num-issues: 999}   # FATAL ERROR: CALL_AND_RETRY_LAST Allocation failed - JavaScript heap out of memory
    - machine: {cpu: 0.5}
      # auto-fix: true    # disabled to avoid break pipeline
      thresholds: {num-issues: 999}   # Prettier finished with errors. (with no error messages in console)

    stylelint:
      auto-fix: true
      thresholds: {num-issues: 479}

    tidy:
    - input:  ["api/"]
      auto-fix: true
      thresholds: {num-issues: 906}
    - ignore: ["api/"]
      auto-fix: true
      thresholds: {num-issues: 440}

    # understand:
    #   thresholds: {num-issues: 999}

    unused:
      options: [--single-occurrence, --all-likelihoods]
      thresholds: {num-issues: 10}
